# KeyStrokeMidiPlayer
このツールはMidiファイル(`.mid`)を読み込み, 定義された`NOTE_ON`を`WM_KEYDOWN`へ, `NOTE_OFF`を`WM_KEYUP`へ変換しキー入力として出力することが出来るツールです.

## 使用方法
"ここへファイルをドラッグ&ドロップ"と書かれたエリアに, midiファイル(.mid)をドロップした後,
再生するトラックを選択し, "再生"を押し, 入力先のウィンドウを選択しアクティブにします.
"停止"を押すと, 現在再生に使用しているスレッドが停止/破棄されます.

### トラックについて
トラック番号0については, 大抵の場合再生に必要な情報のみ入力されているようで, 再生しても恐らく何も起こりません. <br/>
ただ, 極稀にノート(楽譜における音符)が含まれる場合もあるため詳しくは生成されたトグルボタンのテキストを参照してください.
トグルボタンのテキストに表示される楽器名は元のmidiファイルのそのトラックにおける楽器ですが, 正確ではありません.

## Configについて
### config.yaml

| キー                        |    型    | 幅     |  初期値  | 説明                                                                                      |
|---------------------------|:-------:|-------|:-----:|:------------------------------------------------------------------------------------------------|
| debug                     | boolean |       | false |                                                                                                 |
| WindowName                | String  |       |       | キー入力先となるウィンドウの名前の入力フィールドの初期値として使用される                             |
| OutOfRangeCopyNearestNote | boolean |       | true  | 定義されていない音階を再生しようとした際に定義されている値のうち一番近いものを代わりに使用するかどうか |
| forceUsingVKCode          | boolean |       | false | `config.yaml`にて直接vkCodeを記述するかどうか                                                     |
| initialDelay              |   int   |       | 2000  | 初期遅延の入力フィールドの初期値として使用される                                                    |
| NoteNumberOffset          |   int   |       |  15   | `NoteMaxNumber`と`NoteMinNumber`にこの値を加算する.<br/> 定義後の調整に使用するとよい.              |

### keymap.yaml
Core Keeper向けに調整済み(もともとこれで使うツールとして作ったので)
| キー                          | 値                                                                                                                                                        |
|-----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| Midiメッセージにおける音階を表す数値(`int`) | 入力するキーの文字列表現(`String`)<br/>`forceUsingVKCode`が`true`ならキーに対応した[vkCode](https://learn.microsoft.com/ja-jp/windows/win32/inputdev/virtual-key-codes)(`int`) |
"midiメッセージにおける音階を表す数値"について -> 一番低い"ド"は36らしい(ピアノの中央になる"C4"は60とのこと)