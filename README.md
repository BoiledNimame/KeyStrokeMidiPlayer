# KeyStrokeMidiPlayer
このツールはMidiファイル(`.mid`&`.midi`)を読み込み, `NOTE_ON`を`WM_KEYDOWN`へ, `NOTE_OFF`を`WM_KEYUP`メッセージへ変換し他ウィンドウへ送信します. <br/>
要するに:: Midiファイルに記録された入力情報をキー入力として他ウィンドウへ出力するということです.

**Windows APIを使用している関係上、現在動作する環境はWindowsのみです.** (java.awt.Robotへの移行を検討しています)

## 使用方法
"ここへファイルをドラッグ&ドロップ"と書かれたエリアに, midiファイル(.mid)をドロップまたはpathと書かれたフィールドにmidiファイルの絶対パスを入力した後,
再生するトラックを選択し, "再生"を押し, **入力先のウィンドウを選択しアクティブ**にします. <br/>
"停止"を押すと, 現在再生に使用しているスレッドが停止/破棄されます.

### トラックについて
Midiファイルは通常楽器毎にトラックを分けて収録されています. 詳しくはトグルボタンのテキストを参照してください. <br/>
また, トグルボタンのテキストに表示される楽器名は元のmidiファイルのそのトラックにおける楽器ですが, そのMidiファイルを収録した環境に依存するため正確でない可能性があります.

## Configについて
### config.yaml

| キー                        |    型    | 幅     |  初期値  | 説明                                                                                      |
|---------------------------|:-------:|-------|:-----:|:------------------------------------------------------------------------------------------------|
| debug                     | boolean |       | false | デバッグログが増えます.                                                                          |
| WindowName                | String  |       |       | キー入力先となるウィンドウの名前の入力フィールドの初期値として使用される                             |
| forceUsingVKCode          | boolean |       | false | `config.yaml`にて直接vkCodeを記述するかどうか                                                     |
| initialDelay              |   int   |       | 2000  | 初期遅延の入力フィールドの初期値として使用される                                                    |
| NoteNumberOffset          |   int   |       |  15   | 実行時, 元のノート数にこの値を加算する.<br/> 定義後の調整に使用するとよい.              |

「初期値として使用される」と表記のある項目はUIに同じ要素を指す項目が用意されています。
アプリケーション起動時にconfig.yamlの値がその項目に入力され、初期値として用いられますが、実行時にはその項目に入力されているデータが使用されます。

### keymap.yaml
Core Keeper向けに調整済み(もともとこれで使うツールとして作ったので)
| キー                          | 値                                                                                                                                                        |
|-----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| Midiメッセージにおける音階を表す数値(`int`) | 入力するキーの文字列表現(`String`)<br/>`forceUsingVKCode`が`true`ならキーに対応した[vkCode](https://learn.microsoft.com/ja-jp/windows/win32/inputdev/virtual-key-codes)(`int`) |

"midiメッセージにおける音階を表す数値"について -> [ここ](https://tomari.org/main/java/oto.html)と[ここ](https://www.asahi-net.or.jp/~hb9t-ktd/music/Japan/Research/DTM/freq_map.html)に詳しく載っているので`keymap.yaml`を追記する場合はこちらを見てください。
