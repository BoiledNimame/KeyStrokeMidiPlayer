# KeyStrokeMidiPlayer
このツールはMidiファイル(`.mid`)を読み込み, 定義された`NOTE_ON`を`WM_KEYDOWN`へ, `NOTE_OFF`を`WM_KEYUP`へ変換しキー入力として出力することが出来るツールです.

## 使用方法
"ここへファイルをドラッグ&ドロップ"と書かれたエリアに, midiファイル(.mid)をドロップした後,
"トラックを選択▼"より再生するトラックを選択し, "キー入力へ変換"を押してから, "再生"を押し, 入力先のウィンドウを選択しアクティブにします.
"停止"を押すと, 現在再生に使用しているスレッド及び読み込んだmidiデータが破棄されます. (ファイル自体は破棄されません)

### トラックについて
トラック番号0については, 大抵の場合再生に必要な情報のみ入力されているようで, 再生しても恐らく何も起こりません. <br/>
また, 大抵の場合トラック番号の最後尾にある打楽器等が収録されたトラックについては正常な出力が行われない場合があります.
打楽器等が収録されたトラックを更に細かく分割し個別に再生可能にする機能については, 現在実装検討中です.

## Configについて
### generalconfig.json

| キー                        |    型    | 幅     |  初期値  | 説明                                                             |
|---------------------------|:-------:|-------|:-----:|:---------------------------------------------------------------|
| debug                     | boolean |       | false |                                                                |
| WindowName                | String  |       |       | キー入力先となるウィンドウの名前                                               |
| OutOfRangeCopyNearestNote | boolean |       | true  | 定義されていない音階を再生しようとした際に定義されている値のうち一番近いものを代わりに使用するかどうか            |
| forceUsingVKCode          | boolean |       | false | `config.json`にて直接vkCodeを記述するかどうか                               |
| NoteMaxNumber             |   int   | 0~127 |       | `config.json`にて定義する音階値のうち一番低いもの                                |
| NoteMinNumber             |   int   | 0~127 |       | `config.json`にて定義する音階値のうち一番高いもの                                |
| NoteNumberOffset          |   int   |       |  15   | `NoteMaxNumber`と`NoteMinNumber`にこの値を加算する.<br/> 定義後の調整に使用するとよい. |

### config.json
| キー                          | 値                                                                                                                                                        |
|-----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| Midiメッセージにおける音階を表す数値(`int`) | 入力するキーの文字列表現(`String`)<br/>`forceUsingVKCode`が`true`ならキーに対応した[vkCode](https://learn.microsoft.com/ja-jp/windows/win32/inputdev/virtual-key-codes)(`int`) |
